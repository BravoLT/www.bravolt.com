<!DOCTYPE html>
<html class="no-js" lang="en-us">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Performance That Works">
<meta name="author" content="Themefisher.com"> 
<meta name="generator" content="Hugo 0.63.2" />

<title>Bravo LT | Learning &amp; Technology</title>

<!-- Mobile Specific Meta -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Favicon -->
<link rel="shortcut icon" type="image/x-icon" href="//www.bravolt.com/images/favicon.png" />

<!-- Stylesheets -->
<!-- Themefisher Icon font -->
<link rel="stylesheet" href="//www.bravolt.com/plugins/themefisher-font/style.css">
<!-- bootstrap.min css -->
<link rel="stylesheet" href="//www.bravolt.com/plugins/bootstrap/dist/css/bootstrap.min.css">
<!-- Lightbox.min css -->
<link rel="stylesheet" href="//www.bravolt.com/plugins/lightbox2/dist/css/lightbox.min.css">
<!-- Slick Carousel -->
<link rel="stylesheet" href="//www.bravolt.com/plugins/slick-carousel/slick/slick.css">
<link rel="stylesheet" href="//www.bravolt.com/plugins/slick-carousel/slick/slick-theme.css">
<!-- Main Stylesheet -->
<link rel="stylesheet" href="//www.bravolt.com/css/style.css">

</head>

<body id="body">

<!-- Start Preloader -->
<div id="preloader">
    <div class="preloader">
        <div class="sk-circle1 sk-child"></div>
        <div class="sk-circle2 sk-child"></div>
        <div class="sk-circle3 sk-child"></div>
        <div class="sk-circle4 sk-child"></div>
        <div class="sk-circle5 sk-child"></div>
        <div class="sk-circle6 sk-child"></div>
        <div class="sk-circle7 sk-child"></div>
        <div class="sk-circle8 sk-child"></div>
        <div class="sk-circle9 sk-child"></div>
        <div class="sk-circle10 sk-child"></div>
        <div class="sk-circle11 sk-child"></div>
        <div class="sk-circle12 sk-child"></div>
    </div>
</div>
<!-- End Preloader -->

<!-- Fixed Navigation -->
<section class="header navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <nav class="navbar navbar-expand-md">
                    <div class="navbar-brand">
                        <a class="navbar-brand" href="//www.bravolt.com">
                            <img src="//www.bravolt.com/images/logo.png" alt="logo">
                        </a>
                        <a class="rpi-brand" href="/rpi">
                            <img class="rpi-brand" src="/images/rpi-logo-header.png" alt="rpi-logo" />
                        </a>
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="tf-ion-android-menu"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="//www.bravolt.com">Home</a>
                            </li>
                            
                            
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-root" href="/about">About</a>
                                <div class="dropdown-content">
                                
                                    <a class="dropdown-link" href="/blog">Blog</a>
                                
                                    <a class="dropdown-link" href="/care">We Care</a>
                                
                                    <a class="dropdown-link" href="/contact">Contact</a>
                                
                                    <a class="dropdown-link" href="/rpi">Raspberry Pi</a>
                                
                                </div>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/service">Services</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/careers">Careers</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/agile">Agile</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://shop.bravolt.com/collections/all">Shop</a>
                            </li>
                            
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>


<section class="blog-single section">
    <div class="container">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <img src="//www.bravolt.com/images/blog/null.png" class="w-100 mb-3" alt="Post-Image">
                <h2>Getting Started with Nullable Reference Types in C# 8</h2>
                <div class="post-meta mb-5">
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <span>By</span>
                            Ed DeVries, Software Developer
                        </li>
                        <li class="list-inline-item">
                            <span>on</span>
                            <span>May 8, 2019</span>
                        </li>
                    </ul>
                </div>
                <p>The next version of the C# language, C# 8, is scheduled to ship <a href="https://github.com/dotnet/core/blob/master/roadmap.md#upcoming-ship-dates">in September 2019</a> along with .NET Core 3.
C# 8 brings some <a href="https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-8">pretty cool features</a> to the language.
One of the features I&rsquo;m most excited about is Nullable Reference Types, which enables developers to prevent many of the problems that often come along with null values.</p>
<p>C# 8 and .NET Core 3 are already in public preview, so you can give them a whirl right now.
In this post, I&rsquo;m going to walk you through a simple example to demonstrate how to take advantage of Nullable Reference Types.</p>
<p>But first, a bit of background.</p>
<h5 id="value-types-and-reference-types">Value types and reference types</h5>
<p>Data types in C# fall into two broad categories: value types and reference types.</p>
<p>Value types are the simpler kind: integers, Booleans, characters, and so forth.
When you create a variable of a value type, you can think of the variable as &ldquo;holding&rdquo; the value (disclaimer: this is a mental model, not a robust description of your computer&rsquo;s memory).</p>
<p>For instance, the statement</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">int</span> x = <span style="color:#ae81ff">4</span>;
</code></pre></div><p>creates the variable <code>x</code> of type <code>int</code> and gives it the value <code>4</code>.
If you were to do something to <code>x</code>, say,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">x++;
</code></pre></div><p>then <code>x</code> would hold the value <code>5</code> and the value <code>4</code> would be gone.</p>
<p>Reference types are the more complicated kind: objects, strings, etc.
When you create a variable of a reference type, the variable doesn&rsquo;t so much &ldquo;hold&rdquo; the value as &ldquo;point to&rdquo; (or &ldquo;reference&rdquo;) the value.</p>
<p>For instance, the statement</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">Person p = <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Bowser&#34;</span>, LastName = <span style="color:#e6db74">&#34;Castle&#34;</span> };
</code></pre></div><p>creates the variable <code>p</code> of type <code>Person</code>, places the object data somewhere in memory, and gives <code>p</code> the location of that data.</p>
<p>If you were to do something to <em>a property of</em> <code>p</code>, say,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">p.Age = <span style="color:#ae81ff">6</span><span style="color:#ae81ff">2</span>;
</code></pre></div><p><code>p</code> would still hold the same value: a reference to the object.
Only the object data would change.</p>
<p>On the other hand, if you were to do something to <code>p</code> <em>itself</em>, say,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">p = <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Ganon&#34;</span>, LastName = <span style="color:#e6db74">&#34;Tower&#34;</span> };
</code></pre></div><p>a new object would be created in memory (Ganon Tower) and <code>p</code> would be updated with the location of the new object.
The old object (Bowser Castle) would be left hanging around in memory with no variable pointing to it - at least until the <del>plumber</del> garbage collector got around to cleaning it up.</p>
<p>The way that reference types work - pointing to the data rather than holding the data - has a strange consequence: a reference type variable can point to nothing.</p>
<h5 id="null-values">Null values</h5>
<p>In C#, value types cannot be null unless you explicitly declare a variable as nullable.
A statement like</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">bool</span> b = <span style="color:#66d9ef">null</span>;
</code></pre></div><p>will not compile.
There is no such thing as a <code>bool</code> with no value - it has to be either true or false.
In fact, if you fail to provide a value, you&rsquo;ll get a sensible default.
A declaration like</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">bool</span> b;
</code></pre></div><p>will give <code>b</code> the value <code>false</code>, which is the default for Booleans.</p>
<p>Usually, this is a good thing.
In the off chance that you want a nullable value type, you can declare it with a question mark:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">bool?</span> b = <span style="color:#66d9ef">null</span>;
</code></pre></div><p>Reference types, on the other hand, are nullable right from the start.
Let&rsquo;s make that same traditional declaration with a reference type:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">string</span> s;
</code></pre></div><p>We now have a <code>string</code> type variable called <code>s</code>, but we haven&rsquo;t yet created a real <code>string</code> object in memory, so <code>s</code> points to nothing.
This is represented by <code>s</code> getting the value <code>null</code>.</p>
<p>Oddly, even though <code>s</code> does not point to an actual string, the compiler allows you to write expressions like <code>s.Length</code>.
This throws a <code>NullReferenceException</code> because you are attempting to dereference a null reference.
In other words, you are trying to access a member of an object that doesn&rsquo;t exist, so your program blows up.</p>
<p>All the compiler knows is that <code>s</code> is of type <code>string</code>, and objects of type <code>string</code> have a <code>Length</code> property.
Unfortunately, in this case, we have no object, and thus no <code>Length</code> property.</p>
<p>I won&rsquo;t go into why languages like C# allow null references in the first place, partly because it&rsquo;s beyond the scope of this post, but also because the lead designer of C# wrote <a href="https://devblogs.microsoft.com/dotnet/nullable-reference-types-in-csharp/">an excellent article</a> that covers that very topic.
I would recommend it if you&rsquo;re interested in the design rationale behind Nullable Reference Types (which we really <em>will</em> be getting to in just a moment).</p>
<p>For now, all I hope to demonstrate is that we have a conundrum: reference type variables can be null, but the compiler doesn&rsquo;t have a good way to help us to deal with those nulls responsibly.
We are human beings and sometimes we are irresponsible, so we end up with a <code>NullReferenceException</code> at runtime.</p>
<h5 id="nullable-reference-types">Nullable Reference Types</h5>
<p>To solve this problem, C# 8 introduces a feature called &ldquo;Nullable Reference Types&rdquo;.
The feature has two main parts that work together: some familiar syntax you can use to declare which reference types should be nullable and some compiler warnings to help you to follow through on that intent.</p>
<p>Let&rsquo;s see it in action.
If you&rsquo;d like to paint along with us at home, here are the tools we&rsquo;ll be using (all of which are cross-platform):</p>
<ul>
<li><a href="https://dotnet.microsoft.com/download/dotnet-core/3.0">.NET Core SDK 3.0 Preview - latest</a></li>
<li><a href="https://code.visualstudio.com/">Visual Studio Code</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">The C# extension for VS Code</a></li>
</ul>
<p>To begin, we&rsquo;ll open a terminal, create an empty directory, and scaffold a new .NET Core console app:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir nullable-sample
cd nullable-sample
dotnet new console
</code></pre></div><p>There are two new files in our directory.
We&rsquo;ll run <code>code .</code> to inspect them in VS Code.</p>
<p>The project file is <code>nullable-sample.csproj</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;Project</span> <span style="color:#a6e22e">Sdk=</span><span style="color:#e6db74">&#34;Microsoft.NET.Sdk&#34;</span><span style="color:#f92672">&gt;</span>

  <span style="color:#f92672">&lt;PropertyGroup</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;OutputType</span><span style="color:#f92672">&gt;</span>Exe<span style="color:#f92672">&lt;/OutputType&gt;</span>
    <span style="color:#f92672">&lt;TargetFramework</span><span style="color:#f92672">&gt;</span>netcoreapp3.0<span style="color:#f92672">&lt;/TargetFramework&gt;</span>
    <span style="color:#f92672">&lt;RootNamespace</span><span style="color:#f92672">&gt;</span>nullable_sample<span style="color:#f92672">&lt;/RootNamespace&gt;</span>
  <span style="color:#f92672">&lt;/PropertyGroup&gt;</span>

<span style="color:#f92672">&lt;/Project&gt;</span>
</code></pre></div><p>The main program is <code>Program.cs</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System;

<span style="color:#66d9ef">namespace</span> nullable_sample
{
    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Program</span>
    {
        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Main(<span style="color:#66d9ef">string</span>[] args)
        {
            Console.WriteLine(<span style="color:#e6db74">&#34;Hello World!&#34;</span>);
        }
    }
}
</code></pre></div><p>As you can see, <code>dotnet new console</code> created a simple &ldquo;hello world&rdquo; app.
Let&rsquo;s build it and run it, just to get a baseline of the output we expect.</p>
<p><code>dotnet build</code> compiles the code and shows us if it found any problems:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.
    0 Warning(s)
    0 Error(s)
</code></pre></div><p><code>dotnet run</code> both compiles and runs the code, displaying the program&rsquo;s console output:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Hello World!
</code></pre></div><p>Now that we have a running sample, let&rsquo;s add some code.</p>
<p>To demonstrate handling null references, we&rsquo;ll start by defining a <code>Person</code> class to represent someone&rsquo;s full name.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> MiddleName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
}
</code></pre></div><p>Many people have at least a given name and a surname, but middle names are not common in all cultures, and even where they are common, people do not always provide their middle name.
If we have a database of people, it might have a lot of nulls in the middle name column.
Let&rsquo;s create a mock data access class to pretend like we&rsquo;re retrieving the first record we find in a database full of people.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonStore</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Person GetFirstPerson()
        =&gt; <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Pat&#34;</span>, LastName = <span style="color:#e6db74">&#34;McTest&#34;</span> };
}
</code></pre></div><p>Now we can use this data access code in our main program to do something interesting with a <code>Person</code> object, like counting the number of characters in the person&rsquo;s full name and displaying it to the console.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Main(<span style="color:#66d9ef">string</span>[] args)
{
    Person p = PersonStore.GetFirstPerson();

    <span style="color:#66d9ef">int</span> letterCount =
        p.FirstName.Length +
        p.MiddleName.Length +
        p.LastName.Length;

    Console.WriteLine(<span style="color:#e6db74">$&#34;Hello, {p.FirstName}&#34;</span>);
    Console.WriteLine(<span style="color:#e6db74">$&#34;You have {letterCount} letters in your full name&#34;</span>);
}
</code></pre></div><p>That seems easy enough.
However, there is a sneaky bug lurking in this code.
Before we address it, let&rsquo;s see how our program behaves.</p>
<p>The code compiles without issue.
The output of <code>dotnet build</code> is no different than before:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.
    0 Warning(s)
    0 Error(s)
</code></pre></div><p>When we run the code, however, we encounter a problem.
Here is the output of <code>dotnet run</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.
</code></pre></div><p>The problem here is that we neglected to check for null before accessing the <code>Length</code> property of <code>p.MiddleName</code>.
Our mock person record lacks a middle name, so at runtime, <code>p.MiddlName</code> was null.
Let&rsquo;s sweep this bug under the rug by giving Pat a middle initial.
I&rsquo;m feeling lazy today and I need to ship this code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Person GetFirstPerson()
    =&gt; <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Pat&#34;</span>, MiddleName = <span style="color:#e6db74">&#34;Q&#34;</span>, LastName = <span style="color:#e6db74">&#34;McTest&#34;</span> };
</code></pre></div><p>If we run the code, it works! Hooray!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Hello, Pat
You have 10 letters in your full name
</code></pre></div><p>Unfortunately, we now have a more insidious problem.
Our code works fine with our test data, but what will happen when we load a record from a real database and the middle name is missing?</p>
<p>We could uncover the bug by adding more tests - and indeed, we absolutely should - but wouldn&rsquo;t it be great if the compiler could help us fix it right now?</p>
<p>Let&rsquo;s enable the Nullable Reference Types feature.
To do this, we have to add two lines to our project file: one to specify that we&rsquo;re using C# 8 and one to turn on the feature.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;LangVersion</span><span style="color:#f92672">&gt;</span>8.0<span style="color:#f92672">&lt;/LangVersion&gt;</span>
<span style="color:#f92672">&lt;NullableContextOptions</span><span style="color:#f92672">&gt;</span>enable<span style="color:#f92672">&lt;/NullableContextOptions&gt;</span>
</code></pre></div><p>Just to see that in context, here is our modified <code>nullable-sample.csproj</code> file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;Project</span> <span style="color:#a6e22e">Sdk=</span><span style="color:#e6db74">&#34;Microsoft.NET.Sdk&#34;</span><span style="color:#f92672">&gt;</span>

  <span style="color:#f92672">&lt;PropertyGroup</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;OutputType</span><span style="color:#f92672">&gt;</span>Exe<span style="color:#f92672">&lt;/OutputType&gt;</span>
    <span style="color:#f92672">&lt;TargetFramework</span><span style="color:#f92672">&gt;</span>netcoreapp3.0<span style="color:#f92672">&lt;/TargetFramework&gt;</span>
    <span style="color:#f92672">&lt;RootNamespace</span><span style="color:#f92672">&gt;</span>nullable_sample<span style="color:#f92672">&lt;/RootNamespace&gt;</span>
    <span style="color:#f92672">&lt;LangVersion</span><span style="color:#f92672">&gt;</span>8.0<span style="color:#f92672">&lt;/LangVersion&gt;</span>
    <span style="color:#f92672">&lt;NullableContextOptions</span><span style="color:#f92672">&gt;</span>enable<span style="color:#f92672">&lt;/NullableContextOptions&gt;</span>
  <span style="color:#f92672">&lt;/PropertyGroup&gt;</span>

<span style="color:#f92672">&lt;/Project&gt;</span>
</code></pre></div><p>With the feature enabled, let&rsquo;s try to compile our code again. Here is the output of <code>dotnet build</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.

Program.cs(23,23): warning CS8618: Non-nullable property &#39;FirstName&#39; is uninitialized. [/home/ed/source/nullable-sample/nullable-sample.csproj]
Program.cs(24,23): warning CS8618: Non-nullable property &#39;MiddleName&#39; is uninitialized. [/home/ed/source/nullable-sample/nullable-sample.csproj]
Program.cs(25,23): warning CS8618: Non-nullable property &#39;LastName&#39; is uninitialized. [/home/ed/source/nullable-sample/nullable-sample.csproj]
    3 Warning(s)
    0 Error(s)
</code></pre></div><p>The build succeeded, just as before, but now we have some warnings. Progress!</p>
<p>The compiler is telling us two things:</p>
<ul>
<li>The properties of our <code>Person</code> class are all considered &ldquo;non-nullable&rdquo;</li>
<li>Given that they&rsquo;re non-nullable, they should be initialized</li>
</ul>
<p>Wait a minute.
All three properties of <code>Person</code> are strings.
Strings are nullable, right?</p>
<p>Yes, it is just as possible as ever to assign <code>null</code> to a string.
The warnings we received are speaking about our <em>intent</em>.
When the Nullable Reference Types feature is enabled, the compiler considers reference types to be non-nullable by default, just like value types.
If you want a property to be nullable, you have to declare it that way.</p>
<p>Let&rsquo;s say that our application requires each person to have a first and last name but makes the middle name optional.
This means that <code>FirstName</code> and <code>LastName</code> should be initialized to ensure they always have a value.
The empty string would be a sensible default.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; } = <span style="color:#66d9ef">string</span>.Empty;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> MiddleName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; } = <span style="color:#66d9ef">string</span>.Empty;
}
</code></pre></div><p><code>dotnet build</code> now generates only one warning:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.

Program.cs(24,23): warning CS8618: Non-nullable property &#39;MiddleName&#39; is uninitialized. [/home/ed/source/nullable-sample/nullable-sample.csproj]
    1 Warning(s)
    0 Error(s)
</code></pre></div><p>Because <code>MiddleName</code> is optional in our application, instead of initializing it, we&rsquo;ll mark it as nullable.
We do this by appending a question mark to the type, which is the same syntax we used earlier to make a value type nullable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string?</span> MiddleName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</code></pre></div><p>Now we have a more expressive domain model.
<code>FirstName</code> and <code>LastName</code> are required, so we initialize them.
<code>MiddleName</code> is optional, so we mark it as nullable.
The code looks better already.</p>
<p>Let&rsquo;s see how it compiles.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.

Program.cs(13,17): warning CS8602: Dereference of a possibly null reference. [/home/ed/source/nullable-sample/nullable-sample.csproj]
    1 Warning(s)
    0 Error(s)
</code></pre></div><p>Now we have a new warning.
&ldquo;Dereference of a possibly null reference&rdquo; means that we are accessing a member of an object that might be null, and we haven&rsquo;t responsibly checked to make sure it isn&rsquo;t null.
Evidently, the culprit is on line 13.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">Person p = PersonStore.GetFirstPerson();

<span style="color:#66d9ef">int</span> letterCount =
    p.FirstName.Length +
    p.MiddleName.Length +
    p.LastName.Length;
</code></pre></div><p>Line 13 contains <code>p.MiddleName.Length</code>.
This was the line that generated the <code>NullReferenceException</code> earlier, but now we&rsquo;re getting a helpful warning about it.
Because we marked <code>MiddleName</code> as nullable, we have to check to make sure it isn&rsquo;t null before accessing any of its members, in this case its <code>Length</code> property.</p>
<p>Let&rsquo;s add a null check (which we really should have done from the very beginning, had we not been in such a hurry).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">int</span> letterCount =
    p.FirstName.Length +
    (p.MiddleName?.Length ?? <span style="color:#ae81ff">0</span>) +
    p.LastName.Length;
</code></pre></div><p>Now our code builds without warnings:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Build succeeded.
    0 Warning(s)
    0 Error(s)
</code></pre></div><p>The warning went away because the compiler is capable of analyzing the control flow of a program and determining where null values may occur.
By checking to make sure that <code>p.MiddleName</code> was non-null before accessing its <code>Length</code> property, we soothed the compiler&rsquo;s fears.</p>
<p>Our program runs successfully:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Hello, Pat
You have 10 letters in your full name
</code></pre></div><p>But is the bug really fixed?
Recall that earlier, we added a middle name to our test person in order to prevent a <code>NullReferenceException</code>.
Let&rsquo;s remove that test middle name and find out if our code has actually improved.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Person GetFirstPerson()
    =&gt; <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Pat&#34;</span>, LastName = <span style="color:#e6db74">&#34;McTest&#34;</span> };
</code></pre></div><p>The moment of truth. <code>dotnet run</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Hello, Pat
You have 9 letters in your full name
</code></pre></div><p>Success!
Even with a null value in our test data, our program ran safely.</p>
<p>Note that we converted our buggy code to null-safe code simply by following the indications provided to us by the compiler.
This is the real value of the Nullable Reference Types feature: it helps you write safer and more expressive code.</p>
<h5 id="recap">Recap</h5>
<p>You can try out C# 8 with Nullable Reference Types right now.
However, keep in mind that .NET Core 3 still in preview as of the time of writing, so you might not want to use it for production code until the first stable release.</p>
<p>First, <a href="https://dotnet.microsoft.com/download/dotnet-core/3.0">download the latest preview release of .NET Core 3</a>.</p>
<p>Second, specify .NET Core 3, C# 8, and the &ldquo;nullable context options&rdquo; properties in your <code>.csproj</code> file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;TargetFramework</span><span style="color:#f92672">&gt;</span>netcoreapp3.0<span style="color:#f92672">&lt;/TargetFramework&gt;</span>
<span style="color:#f92672">&lt;LangVersion</span><span style="color:#f92672">&gt;</span>8.0<span style="color:#f92672">&lt;/LangVersion&gt;</span>
<span style="color:#f92672">&lt;NullableContextOptions</span><span style="color:#f92672">&gt;</span>enable<span style="color:#f92672">&lt;/NullableContextOptions&gt;</span>
</code></pre></div><p>Third, explicitly indicate that a reference type should be allowed to carry null values by appending a question mark to the type:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string?</span> MiddleName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</code></pre></div><p>And finally, pay attention to the warnings you get from <code>dotnet build</code> and use them as a guide to improving your code.</p>
<p>If you&rsquo;d like to see the full example app we walked through in this post, it&rsquo;s available <a href="https://github.com/ehdevries/learning-nullable-reference-types">on GitHub</a>.</p>
<h5 id="going-further">Going further</h5>
<p>By design, the Nullable Reference Types feature generates warnings, not errors.
This is so that you can start fixing problems in existing code without spilling noisy red ink all over the place.</p>
<p>If you do want actual errors that fail the build, you can choose to treat all warnings as errors.
This is an existing feature in current versions of .NET (not just in .NET Core 3), and it can be enabled by adding one more property to a <code>PropertyGroup</code> in your <code>.csproj</code> file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;TreatWarningsAsErrors</span><span style="color:#f92672">&gt;</span>true<span style="color:#f92672">&lt;/TreatWarningsAsErrors&gt;</span>
</code></pre></div><p>We covered the basics of Nullable Reference Types in this post, but there is even more to the feature.
If you&rsquo;d like to dig deeper, check out these articles:</p>
<ul>
<li><em><a href="https://devblogs.microsoft.com/dotnet/nullable-reference-types-in-csharp/">Introducing Nullable Reference Types in C#</a></em> by Mads Torgerson</li>
<li>Microsoft&rsquo;s <a href="https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references">official guide</a> to Nullable Reference Types</li>
<li>Microsoft&rsquo;s <a href="https://docs.microsoft.com/en-us/dotnet/csharp/tutorials/nullable-reference-types">official tutorial</a> on Nullable Reference Types</li>
</ul>

            </div>
        </div>
    </div>
</section>

<!-- Footer Start -->
<footer id="footer" class="bg-one">
    <div class="top-footer">
        <div class="container">
            <div class="row">
                <div class="col-sm-3 col-md-3 col-lg-3">
                    <h3>Mission</h3>
                    <p>Our mission is to empower our clients, team, and community to succeed through compassion, professionalism, and the power of technology.</p>
                </div>
                <div class="col-sm-3 col-md-3 col-lg-3">
                    <h3>Services</h3>
                    <ul>
                        
                        <li>
                            <a href="/service">Custom Technology Solutions</a>
                        </li>
                        
                        <li>
                            <a href="/service">Team Members</a>
                        </li>
                        
                        <li>
                            <a href="/service">In-House Development Team</a>
                        </li>
                        
                        <li>
                            <a href="/agile">Agile Training</a>
                        </li>
                        
                    </ul>
                </div>
                <div class="col-sm-3 col-md-3 col-lg-3">
                    <h3>Quick Links</h3>
                    <ul>
                        
                        <li>
                            <a href="/about">About</a>
                        </li>
                        
                        <li>
                            <a href="/contact">Contact</a>
                        </li>
                        
                        <li>
                            <a href="/careers">Careers</a>
                        </li>
                        
                    </ul>
                </div>
                
                <div class="col-sm-3 col-md-3 col-lg-3">
                            <h3>Social</h3>
                        <ul class="list-inline social-icon">
                            
                            <li class="list-inline-item">
                                <a target="_blank" href="https://www.facebook.com/BravoLT">
                                    <i class="tf-ion-social-facebook"></i>
                                </a>
                            </li>
                            
                            
                            <li class="list-inline-item">
                                <a target="_blank" href="https://twitter.com/bravo_lt">
                                    <i class="tf-ion-social-twitter"></i>
                                </a>
                            </li>
                            
                            
                            <li class="list-inline-item">
                                <a target="_blank" href="https://www.linkedin.com/company/bravo-learning-technologies">
                                    <i class="tf-ion-social-linkedin"></i>
                                </a>
                            </li>
                            
                            
                            <li class="list-inline-item">
                                <a target="_blank" href="https://www.instagram.com/bravo_lt">
                                    <i class="tf-ion-social-instagram"></i>
                                </a>
                            </li>
                            
                            
                            <li class="list-inline-item">
                                <a target="_blank" href="https://github.com/bravolt">
                                    <i class="tf-ion-social-github"></i>
                                </a>
                            </li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <h5>Copyright Bravo LT <span id="copyrightYear">****</span>. All rights reserved.</h5>
    </div>
</footer>
<!-- end footer -->


<!-- Essential Scripts -->

<!-- jQuery -->
<script src="//www.bravolt.com/plugins/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//www.bravolt.com/plugins/bootstrap/dist/js/popper.min.js"></script>
<script src="//www.bravolt.com/plugins/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Parallax -->
<script src="//www.bravolt.com/plugins/parallax/jquery.parallax-1.1.3.js"></script>
<!-- lightbox -->
<script src="//www.bravolt.com/plugins/lightbox2/dist/js/lightbox.min.js"></script>
<!-- Slick Carousel -->
<script src="//www.bravolt.com/plugins/slick-carousel/slick/slick.min.js"></script>
<!-- Portfolio Filtering -->
<script src="//www.bravolt.com/plugins/mixitup/dist/mixitup.min.js"></script>
<!-- Smooth Scroll js -->
<script src="//www.bravolt.com/plugins/smooth-scroll/dist/js/smooth-scroll.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCC72vZw-6tGqFyRhhg5CkF2fqfILn2Tsw"></script>
<!-- Custom js -->
<script src="//www.bravolt.com/js/script.js"></script>

</body>

</html>

